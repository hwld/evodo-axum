{
  "db_name": "SQLite",
  "query": "\n        WITH RECURSIVE ancestors AS (\n            -- 非再帰\n            -- サブタスクの親のステータスは関係ないのでNULLにする\n            SELECT parent_task_id, subtask_id as child_task_id, NULL as parent_task_status\n            FROM subtask_connections\n            WHERE subtask_id = $1\n\n            UNION\n\n            SELECT blocking_task_id as parent_task_id, blocked_task_id as child_task_id, status\n            FROM blocking_tasks b JOIN tasks t ON b.blocking_task_id = t.id\n            WHERE blocked_task_id = $1\n\n            UNION\n\n            -- 再帰\n            SELECT s.parent_task_id, a.child_task_id, NULL as status\n            FROM subtask_connections s\n            JOIN ancestors a ON s.subtask_id = a.parent_task_id\n\n            UNION\n\n            SELECT b.blocking_task_id, a.child_task_id, t.status\n            FROM blocking_tasks b\n            JOIN ancestors a ON b.blocked_task_id = a.parent_task_id\n            JOIN tasks t ON b.blocking_task_id = t.id\n        )\n\n        SELECT COUNT(*) as non_done_status_count\n        FROM ancestors a\n        WHERE a.parent_task_status != 'Done'\n        ",
  "describe": {
    "columns": [
      {
        "name": "non_done_status_count",
        "ordinal": 0,
        "type_info": "Int"
      }
    ],
    "parameters": {
      "Right": 1
    },
    "nullable": [
      false
    ]
  },
  "hash": "b9cdc9340db53917c2dff2abfe1ffc1f0dfa9f31ba17c4c8017cd52e877d7b95"
}
